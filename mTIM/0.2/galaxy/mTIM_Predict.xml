<tool id="mTIMPredict" name="mTIM-Predict" version="0.2">
  <description> Genome-wide prediction with mTIM</description>
  <command interpreter="bash">bin/mTIM_predict
    #if $genome_input.select_genome_format=="0":
    -g $genome_input.fasta_input_selected
    #else
    -G $genone_input.gio_input_selected.extra_files_path 
    #end if
    #if $align_input.select_align_format=="0":
    -b $align_input.bam_input_selected
    #else
    -s $align_input.sam_input_selected
    #end if
    -a $accpred.extra_files_path 
    -d $donpred.extra_files_path
    -m trained_models/mtim_model_trained2011-04-13_13h10_octave.mat
    -o $mtim_gff3_out 
    -O $mtim_gann_out.extra_files_path 
    -Q $mtim_gann_out 
    -i $infer_orf
    -e $gen_graph
    >> $Log_File
</command>
  <inputs>
    <conditional name="genome_input">
      <param name="select_genome_format" type="select" label="Genome sequence format" help="Select the format of your genome sequence." >
	<option value="0">FASTA</option>
	<option value="1">GIO (mGene)</option>
      </param>
      <when value="0">
	<param format="fasta" name="fasta_input_selected" type="data" label="Genome sequence in FASTA format" help=""/>
      </when>
      <when value="1">
	<param format="gio" name="gio_input_selected" type="data" label="Genome information object" help="Internal representation of the genomic sequence (e.g., chromosomes or contigs). The GIO file can be created with mGene's GenomeTool."/>
      </when>
    </conditional> 
    <conditional name="align_input">
      <param name="select_align_format" type="select" label="Read alignment format" help="Select the format of your RNA-seq read alignments." >
	<option value="0">BAM</option>
	<option value="1">SAM</option>
      </param>
      <when value="0">
	<param format="bam" name="bam_input_selected" type="data" label="RNA-seq read alignments in BAM format" help=""/>
      </when>
      <when value="1">
	<param format="sam" name="sam_input_selected" type="data" label="RNA-seq read alignments in SAM format" help=""/>
      </when>
    </conditional> 
    <param format="spf" name="accpred" type="data" label="Acceptor splice site predictions in SPF format" help="The prediction file contains a signal prediction score for each candidate acceptor splice site. It can be generated with mGenes SignalPredict tool or the ASP tool."/>
    <param format="spf" name="donpred" type="data" label="Donor splice site predictions in SPF format" help="The prediction file contains a signal prediction score for each candidate donor splice site. It can be generated with mGenes SignalPredict tool or the ASP tool."/>
    <param name="gen_graph" type="select" label="Run SplAdder on to detect alternative isoforms" help="">
      <option value="0">No</option>
      <option value="1">Yes</option>
    </param>
    <param name="infer_orf" type="select" label="Infer an open reading frame for generated transcripts" help="">
      <option value="1">Yes</option>
      <option value="0">No</option>
    </param>
  </inputs>
  <outputs>
      <data format="gff3" name="mtim_gff3_out" label="${tool.name} on ${on_string}: Predicted Transcripts"/>
      <data format="gann" name="mtim_gann_out" label="${tool.name} on ${on_string}: Predicted Transcripts in AGS"/>
      <data format="txt" name="Log_File" label="${tool.name} on ${on_string}: Log file"/>
  </outputs>
  <help>

.. class:: infomark

**What it does** 

`mTIM Predict` uses a trained mTIM predictor and performs genomewide predictions.

**Inputs**

`mTIM Predict` requires three inputs to run:

1. The genome sequence, either in FASTA or GIO format, containing essential information about the genome (sequence, size, etc).
2. Acceptor and donor splice site predictions in SPF format. They can be obtained using the `SignalPredict` tool in the `mGene Modules` section.
3. Read alignments, either in BAM or SAM format


**Output**

`mTIM Predict` generates transcript predictions in GFF3 and AGS formats.

------

.. class:: infomark

**About formats**

**GIO format** Genome Information Object is an internal format used to
store relevant information about the genome under consideration (as
extracted from a FASTA file). It includes, for example, number and
length of chromosomes/contigs. The file is generated by applying the
`GenomeTool`.

**AGS format** Annotation Gene Structure Object is an internal
structure that efficiently stores the information from a GFF3 file. It
can be generated with the `GFF2Anno` tool. 


</help>
</tool>
